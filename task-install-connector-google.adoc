---
sidebar: sidebar 
permalink: task-install-connector-google.html 
keywords: install connector, google cloud connector installation, google cloud connector, install connector in google cloud, bluexp, gcloud, manual install, create connector, gcp installation, gcp connector 
summary: 直接从基于Web的BlueXP控制台、使用gcloud或在您自己的Linux主机上安装软件来创建Connector。 
---
= 在 Google Cloud 中创建 Connector
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
直接从基于Web的BlueXP控制台、使用gcloud或在您自己的Linux主机上安装软件来创建Connector。

[role="tabbed-block"]
====
.BlueXP
--
.您需要的内容
* 为Connector VM创建Connector和服务帐户所需的Google Cloud权限。
+
link:task-set-up-permissions-google.html["了解如何设置Google Cloud权限"]

* 满足网络连接要求的VPC和子网。
+
link:task-set-up-networking-google.html["了解网络连接要求"]

* 有关代理服务器的详细信息、如果从Connector访问Internet需要代理。


.步骤
. 单击*连接器*下拉列表并选择*添加连接器*。
+
image:screenshot_connector_add.gif["标题中显示 Connector 图标和 Add Connector 操作的屏幕截图。"]

. 选择 * Google Cloud Platform* 作为云提供商。
. 在*部署Connector*页面上、查看有关所需内容的详细信息。您有两种选择：
+
.. 单击*继续*以使用产品指南为部署做准备。产品指南中的每个步骤都包含文档本页中包含的信息。
.. 如果您已按照此页面上的步骤做好准备、请单击*跳至部署*。


. 按照向导中的步骤创建 Connector ：
+
** 如果出现提示，请登录到您的 Google 帐户，该帐户应具有创建虚拟机实例所需的权限。
+
此表由 Google 拥有和托管。您的凭据不会提供给 NetApp 。

** *详细信息*：输入虚拟机实例的名称、指定标记、选择项目、然后选择具有所需权限的服务帐户(有关详细信息、请参见上述部分)。
** * 位置 * ：指定实例的区域，分区， VPC 和子网。
** * 网络 * ：选择是否启用公有 IP 地址，并可选择指定代理配置。
** *防火墙策略*：选择是创建新的防火墙策略，还是选择允许所需入站和出站规则的现有防火墙策略。
+
link:reference-ports-gcp.html["Google Cloud中的防火墙规则"]

** * 审核 * ：查看您选择的内容，确认您的设置正确无误。


. 单击 * 添加 * 。
+
此实例应在大约 7 分钟后准备就绪。您应停留在页面上，直到此过程完成。



.结果
此过程完成后、即可从BlueXP使用Connector。

--
.云
--
.您需要的内容
* 为Connector VM创建Connector和服务帐户所需的Google Cloud权限。
+
link:task-set-up-permissions-google.html["了解如何设置Google Cloud权限"]

* 满足网络连接要求的VPC和子网。
+
link:task-set-up-networking-google.html["了解网络连接要求"]



.步骤
. 使用您首选的方法登录到 gcloud SDK 。
+
在我们的示例中、我们将使用安装了gcloud SDK的本地Shell、但您可以在Google云控制台中使用原生 Google Cloud Shell。

+
有关 Google Cloud SDK 的详细信息，请访问 link:https://cloud.google.com/sdk["Google Cloud SDK 文档页面"^]。

. 验证您是否以具有上一节中定义的所需权限的用户身份登录：
+
[source, bash]
----
gcloud auth list
----
+
输出应显示以下内容，其中 * 用户帐户是要以身份登录的所需用户帐户：

+
[listing]
----
Credentialed Accounts
ACTIVE  ACCOUNT
     some_user_account@domain.com
*    desired_user_account@domain.com
To set the active account, run:
 $ gcloud config set account `ACCOUNT`
Updates are available for some Cloud SDK components. To install them,
please run:
$ gcloud components update
----
. 运行 `gcloud compute instances create` 命令：
+
[source, bash]
----
gcloud compute instances create <instance-name>
  --machine-type=n2-standard-4
  --image-project=netapp-cloudmanager
  --image-family=cloudmanager
  --scopes=cloud-platform
  --project=<project>
  --service-account=<service-account>
  --zone=<zone>
  --no-address
  --tags <network-tag>
  --network <network-path>
  --subnet <subnet-path>
  --boot-disk-kms-key <kms-key-path>
----
+
实例名称:: VM 实例所需的实例名称。
项目:: （可选）要部署 VM 的项目。
服务帐户:: 步骤 2 输出中指定的服务帐户。
分区:: 要部署 VM 的区域
无地址:: （可选）不使用外部 IP 地址（您需要云 NAT 或代理将流量路由到公有 Internet ）
网络标记:: （可选）添加网络标记以使用标记将防火墙规则链接到 Connector 实例
网络路径:: （可选）添加要将 Connector 部署到的网络的名称（对于共享 VPC ，您需要完整路径）
子网路径:: （可选）添加要将 Connector 部署到的子网的名称（对于共享 VPC ，您需要完整路径）
kms-key-path:: （可选）添加 KMS 密钥以加密连接器的磁盘（还需要应用 IAM 权限）
+
--
有关这些标志的详细信息，请访问 link:https://cloud.google.com/sdk/gcloud/reference/compute/instances/create["Google Cloud 计算 SDK 文档"^]。

--


+
运行命令可使用 NetApp 黄金映像部署 Connector 。Connector 实例和软件应在大约五分钟内运行。

. 从已连接到 Connector 实例的主机打开 Web 浏览器，然后输入以下 URL ：
+
https://_ipaddress_[]

. 登录后，设置 Connector ：
+
.. 指定要与Connector关联的BlueXP帐户。
+
link:concept-netapp-accounts.html["了解有关BlueXP帐户的信息"]。

.. 输入系统名称。




.结果
现在、您可以使用BlueXP帐户安装并设置Connector。

打开Web浏览器并转到 https://console.bluexp.netapp.com["BlueXP控制台"^] 开始将Connector与BlueXP结合使用。

--
.手动安装
--
.您需要的内容
* 安装Connector的root权限。
* 有关代理服务器的详细信息、如果从Connector访问Internet需要代理。
+
您可以选择在安装后配置代理服务器、但这样做需要重新启动Connector。

* CA签名证书、如果代理服务器使用HTTPS或代理是截获代理。


.关于此任务
NetApp 支持站点上提供的安装程序可能是早期版本。安装后，如果有新版本可用， Connector 会自动进行更新。

.步骤
. 验证 Docker 是否已启用且正在运行。
+
[source, cli]
----
sudo systemctl enable docker && sudo systemctl start docker
----
. 如果在主机上设置了_http_proxy_或_https_proxy_系统变量、请将其删除：
+
[source, cli]
----
unset http_proxy
unset https_proxy
----
+
如果不删除这些系统变量、安装将失败。

. 从下载Connector软件 https://mysupport.netapp.com/site/products/all/details/cloud-manager/downloads-tab["NetApp 支持站点"^]，然后将其复制到 Linux 主机。
+
您应下载用于您的网络或云中的"联机"Connector安装程序。Connector可以使用单独的"脱机"安装程序、但只有专用模式部署才支持此安装程序。

. 分配运行脚本的权限。
+
[source, cli]
----
chmod +x OnCommandCloudManager-<version>
----
+
其中、<version> 是您下载的连接器版本。

. 运行安装脚本。
+
[source, cli]
----
 ./OnCommandCloudManager-<version> --proxy <HTTP or HTTPS proxy server> --cacert <path and file name of a CA-signed certificate>
----
+
-proxy和-cacert参数是可选的。如果您有代理服务器、则需要输入所示的参数。安装程序不会提示您提供有关代理的信息。

+
以下是使用这两个可选参数的命令示例：

+
[source, cli]
----
 ./OnCommandCloudManager-V3.9.26 --proxy https://user:password@10.0.0.30:8080/ --cacert /tmp/cacert/certificate.cer
----
+
-proxy会将Connector配置为使用以下格式之一的HTTP或HTTPS代理服务器：

+
** http://address:port
** http://username:password@address:port
** https://address:port
** https://username:password@address:port
+
用户必须是本地用户。不支持域用户。



+
-cacert指定用于在Connector和代理服务器之间进行HTTPS访问的CA签名证书。只有在指定HTTPS代理服务器或代理为截获代理时、才需要此参数。

. 等待安装完成。
+
在安装结束时、如果您指定了代理服务器、则Connector服务(occa)将重新启动两次。

. 从已连接到 Connector 虚拟机的主机打开 Web 浏览器，然后输入以下 URL ：
+
https://_ipaddress_[]

. 登录后，设置 Connector ：
+
.. 指定要与Connector关联的BlueXP帐户。
.. 输入系统名称。
.. 在*是否在安全环境中运行？*下、保持禁用受限模式。
+
您应始终禁用受限模式、因为这些步骤说明了如何在标准模式下使用BlueXP。只有在您拥有安全环境并希望将此帐户与BlueXP后端服务断开连接时、才应启用受限模式。如果是这种情况、 link:task-quick-start-restricted-mode.html["按照步骤在受限模式下开始使用BlueXP"]。

.. 单击*我们开始*。




.结果
现在、Connector已安装完毕、并已使用您的BlueXP帐户进行设置。

.下一步是什么？
link:task-provide-permissions-google.html["为BlueXP提供您先前设置的权限"]。

--
====