---
sidebar: sidebar 
permalink: task-install-connector-aws.html 
keywords: install connector, aws connector installation, aws connector, install connector in aws, bluexp, aws marketplace, manual install, create connector 
summary: 直接从基于Web的BlueXP控制台、AWS Marketplace或通过在您自己的Linux主机上安装软件来创建Connector。 
---
= 在 AWS 中创建连接器
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
直接从基于Web的BlueXP控制台、AWS Marketplace或通过在您自己的Linux主机上安装软件来创建Connector。

[role="tabbed-block"]
====
.BlueXP
--
.您需要的内容
* AWS身份验证方法：IAM角色或具有所需权限的IAM用户的访问密钥。
+
link:task-set-up-permissions-aws.html["了解如何设置AWS权限"]

* 满足网络连接要求的VPC和子网。
+
link:task-set-up-networking-aws.html["了解网络连接要求"]

* EC2实例的密钥对。
* 有关代理服务器的详细信息、如果从Connector访问Internet需要代理。


.步骤
. 单击*连接器*下拉列表并选择*添加连接器*。
+
image:screenshot_connector_add.gif["标题中显示 Connector 图标和 Add Connector 操作的屏幕截图。"]

. 选择 * Amazon Web Services* 作为您的云提供商，然后单击 * 继续 * 。
. 在*部署Connector*页面上、查看有关所需内容的详细信息。您有两种选择：
+
.. 单击*继续*以使用产品指南为部署做准备。产品指南中的每个步骤都包含文档本页中包含的信息。
.. 如果您已按照此页面上的步骤做好准备、请单击*跳至部署*。


. 按照向导中的步骤创建 Connector ：
+
** * 准备就绪 * ：查看您需要的内容。
** * AWS Credentials*：指定您的AWS区域、然后选择身份验证方法、即BlueXP可以承担的IAM角色或AWS访问密钥和机密密钥。
+

TIP: 如果选择 * 承担角色 * ，则可以从 Connector 部署向导创建第一组凭据。必须从 " 凭据 " 页面创建任何其他凭据集。然后，这些文件将从向导的下拉列表中显示。 link:task-adding-aws-accounts.html["了解如何添加其他凭据"]。

** * 详细信息 * ：提供有关连接器的详细信息。
+
*** 输入实例的名称。
*** 向实例添加自定义标记（元数据）。
*** 选择是希望BlueXP创建具有所需权限的新角色、还是要选择使用设置的现有角色 link:reference-permissions-aws.html["所需权限"]。
*** 选择是否要对 Connector 的 EBS 磁盘进行加密。您可以选择使用默认加密密钥或自定义密钥。


** * 网络 * ：指定实例的 VPC ，子网和密钥对，选择是否启用公有 IP 地址，并可选择指定代理配置。
+
确保您具有可用于Connector的正确密钥对。如果没有密钥对、您将无法访问Connector虚拟机。

** *安全组*：选择是创建新安全组还是选择允许所需入站和出站规则的现有安全组。
+
link:reference-ports-aws.html["查看AWS的安全组规则"]。

** * 审核 * ：查看您选择的内容，确认您的设置正确无误。


. 单击 * 添加 * 。
+
此实例应在大约 7 分钟后准备就绪。您应停留在页面上，直到此过程完成。



.结果
此过程完成后、即可从BlueXP使用Connector。

--
.AWS Marketplace
--
.您需要的内容
* 满足网络连接要求的VPC和子网。
+
link:task-set-up-networking-aws.html["了解网络连接要求"]。

* 一个IAM角色、其附加策略包括Connector所需的权限。
+
link:task-set-up-permissions-aws.html["了解如何设置AWS权限"]。

* 为IAM用户订阅和取消订阅AWS Marketplace的权限。
* EC2实例的密钥对。


.步骤
. 转至 https://aws.amazon.com/marketplace/pp/B018REK8QG["AWS Marketplace上的BlueXP页面"^]
. 在 Marketplace 页面上，单击 * 继续订阅 * ，然后单击 * 继续配置 * 。
+
image:screenshot-subscribe-aws.png["屏幕截图显示了 AWS Marketplace 上的 Continue to Subscribe and Continue to Configuration 按钮。"]

. 更改任何默认选项，然后单击 * 继续启动 * 。
. 在 * 选择操作 * 下，选择 * 通过 EC2 启动 * ，然后单击 * 启动 * 。
+
以下步骤介绍了如何从EC2控制台启动实例、因为控制台允许您将IAM角色附加到Connector实例。使用 * 从网站启动 * 操作无法实现这一点。

. 按照提示配置和部署实例：
+
** *名称和标记*：输入实例的名称和标记。
** *应用程序和操作系统映像*：跳过此部分。已选择连接器AMI。
** *实例类型*：根据区域可用性、选择支持的实例类型之一(建议使用T3.xlarge)。
+
link:reference-host-requirements-aws.html["查看实例要求"]。

** *密钥对(login)*：选择要用于安全连接到实例的密钥对。
** *网络设置*：根据需要编辑网络设置：
+
*** 选择所需的VPC和子网。
*** 指定实例是否应具有公有 IP地址。
*** 指定防火墙设置、以便为Connector实例启用所需的连接方法：SSH、HTTP和HTTPS。
+
对于特定配置、还需要一些规则。

+
link:reference-ports-aws.html["查看AWS的安全组规则"]。



** *配置存储*：保留默认存储选项。
** *高级详细信息*：在* IAM实例配置文件*下、选择包含Connector所需权限的IAM角色。
+
link:task-set-up-permissions-aws.html["了解如何设置AWS权限"]。

** *摘要*：查看摘要、然后单击*启动实例*。


+
AWS 使用指定的设置启动软件。Connector 实例和软件应在大约五分钟内运行。

. 从已连接到 Connector 虚拟机的主机打开 Web 浏览器，然后输入以下 URL ：
+
https://_ipaddress_[]

. 登录后，设置 Connector ：
+
.. 指定要与Connector关联的BlueXP帐户。
.. 输入系统名称。
.. 在*是否在安全环境中运行？*下、保持禁用受限模式。
+
您应始终禁用受限模式、因为这些步骤说明了如何在标准模式下使用BlueXP。只有在您拥有安全环境并希望将此帐户与BlueXP后端服务断开连接时、才应启用受限模式。如果是这种情况、 link:task-quick-start-restricted-mode.html["按照步骤在受限模式下开始使用BlueXP"]。

.. 单击*我们开始*。




.结果
现在、您可以使用BlueXP帐户安装并设置Connector。

打开Web浏览器并转到 https://console.bluexp.netapp.com["BlueXP控制台"^] 开始将Connector与BlueXP结合使用。

--
.手动安装
--
.您需要的内容
* 安装Connector的root权限。
* 有关代理服务器的详细信息、如果从Connector访问Internet需要代理。
+
您可以选择在安装后配置代理服务器、但这样做需要重新启动Connector。

* CA签名证书、如果代理服务器使用HTTPS或代理是截获代理。


.关于此任务
NetApp 支持站点上提供的安装程序可能是早期版本。安装后，如果有新版本可用， Connector 会自动进行更新。

.步骤
. 验证 Docker 是否已启用且正在运行。
+
[source, cli]
----
sudo systemctl enable docker && sudo systemctl start docker
----
. 如果在主机上设置了_http_proxy_或_https_proxy_系统变量、请将其删除：
+
[source, cli]
----
unset http_proxy
unset https_proxy
----
+
如果不删除这些系统变量、安装将失败。

. 从下载Connector软件 https://mysupport.netapp.com/site/products/all/details/cloud-manager/downloads-tab["NetApp 支持站点"^]，然后将其复制到 Linux 主机。
+
您应下载用于您的网络或云中的"联机"Connector安装程序。Connector可以使用单独的"脱机"安装程序、但只有专用模式部署才支持此安装程序。

. 分配运行脚本的权限。
+
[source, cli]
----
chmod +x OnCommandCloudManager-<version>
----
+
其中、<version> 是您下载的连接器版本。

. 运行安装脚本。
+
[source, cli]
----
 ./OnCommandCloudManager-<version> --proxy <HTTP or HTTPS proxy server> --cacert <path and file name of a CA-signed certificate>
----
+
-proxy和-cacert参数是可选的。如果您有代理服务器、则需要输入所示的参数。安装程序不会提示您提供有关代理的信息。

+
以下是使用这两个可选参数的命令示例：

+
[source, cli]
----
 ./OnCommandCloudManager-V3.9.26 --proxy https://user:password@10.0.0.30:8080/ --cacert /tmp/cacert/certificate.cer
----
+
-proxy会将Connector配置为使用以下格式之一的HTTP或HTTPS代理服务器：

+
** \http://address:port
** \http://username:password@address:port
** \https://address:port
** \https://username:password@address:port
+
用户必须是本地用户。不支持域用户。



+
-cacert指定用于在Connector和代理服务器之间进行HTTPS访问的CA签名证书。只有在指定HTTPS代理服务器或代理为截获代理时、才需要此参数。

. 等待安装完成。
+
在安装结束时、如果您指定了代理服务器、则Connector服务(occa)将重新启动两次。

. 从已连接到 Connector 虚拟机的主机打开 Web 浏览器，然后输入以下 URL ：
+
https://_ipaddress_[]

. 登录后，设置 Connector ：
+
.. 指定要与Connector关联的BlueXP帐户。
.. 输入系统名称。
.. 在*是否在安全环境中运行？*下、保持禁用受限模式。
+
您应始终禁用受限模式、因为这些步骤说明了如何在标准模式下使用BlueXP。只有在您拥有安全环境并希望将此帐户与BlueXP后端服务断开连接时、才应启用受限模式。如果是这种情况、 link:task-quick-start-restricted-mode.html["按照步骤在受限模式下开始使用BlueXP"]。

.. 单击*我们开始*。




.结果
现在、Connector已安装完毕、并已使用您的BlueXP帐户进行设置。

.下一步是什么？
link:task-provide-permissions-aws.html["为BlueXP提供您先前设置的权限"]。

--
====